import{_ as D,o as u,c as m,e as l,n as p,h as n,l as h,m as d,f as c,t as g,k as f,p as w,q as v}from"../app.fd4c7dea.js";const z={props:{before:{type:String,default:"https://image-compare.netlify.com/assets/before.jpg"},after:{type:String,default:"https://image-compare.netlify.com/assets/after.jpg"},full:{type:Boolean,default:!1},padding:{type:Object,required:!1,default(){return{left:0,right:0}}},hideAfter:{type:Boolean,default:!1,required:!1},zoom:{type:Object,required:!1,default(){return{min:.5,max:2}}},isZoomable:{type:Boolean,default:!1,required:!1},isDraggable:{type:Boolean,default:!1,required:!1},isSwitchable:{type:Boolean,default:!1,required:!1},hideHandle:{type:Boolean,default:!1,required:!1},reset:{type:Boolean,default:!1,required:!1},labels:{type:Object,required:!1,default(){return{after:"",before:""}}}},data(){return{width:null,height:null,pageX:null,pageY:null,posX:null,isDraggingHandle:!1,isDraggingImage:!1,allowNextFrame:!0,diffX:0,diffY:0,shiftX:0,shiftY:0,mutableZoom:1,mutableBefore:this.before,mutableAfter:this.after,showDropzone:!1,showAfter:!0,beforeName:"",beforeSize:"",afterName:"",afterSize:""}},computed:{afterLabel(){return this.afterName||this.labels.after},beforeLabel(){return this.beforeName||this.labels.before},isDragging(){return this.isDraggingImage||this.isDraggingHandle},dimensions(){const e=parseFloat(this.mutableZoom.toFixed(2));return{width:`${this.width}px`,height:this.full?`${this.height}px`:"auto",transform:`scale(${e}) translate(${this.shiftX}px, ${this.shiftY}px)`}},paddingTotal(){return this.padding.left+this.padding.right}},watch:{reset(){this.shiftX=0,this.shiftY=0,this.setInitialPosX()},paddingTotal(){this.setInitialPosX()}},created(){window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("resize",this.onResize),window.addEventListener("contextmenu",this.onRightClick),window.addEventListener("dragenter",this.onDragEnter),window.addEventListener("dragover",this.onDragOver),window.addEventListener("drop",this.onDrop)},mounted(){this.$el.addEventListener("wheel",this.onWheel),this.onResize()},beforeDestroy(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("resize",this.onResize),this.$el.removeEventListener("wheel",this.onWheel),window.removeEventListener("contextmenu",this.onRightClick),window.removeEventListener("dragenter",this.onDragEnter),window.removeEventListener("dragover",this.onDragOver),window.removeEventListener("drop",this.onDrop)},methods:{onResize(){this.width=this.$el.clientWidth,this.height=this.$el.clientHeight,this.setInitialPosX()},onMouseDownHandle(){this.$emit("movement"),this.isDraggingHandle=!0},onMouseDownImage(){this.isDraggable&&(this.isDraggingImage=!0,this.$emit("movement"))},onMouseUp(e){e.preventDefault(),this.isDraggingHandle=!1,this.isDraggingImage=!1,this.pageX=null,this.pageY=null,e.button===1&&this.onWheelClick()},onMouseMove(e,t=!1){if(this.$emit("movement"),!(e&&e.type==="click"&&this.isDraggable)&&e&&this.allowNextFrame&&(this.isDragging||t)){this.allowNextFrame=!1;let i=e.pageX,o=e.pageY;e.targetTouches?(i=e.targetTouches[0].pageX,o=e.targetTouches[0].pageY):e.originalEvent&&e.originalEvent.targetTouches&&(i=e.originalEvent.targetTouches[0].pageX,o=e.originalEvent.targetTouches[0].pageY),this.diffX=this.pageX?i-this.pageX:0,this.diffY=this.pageY?o-this.pageY:0,this.pageX=i,this.pageY=o,window.requestAnimationFrame(this.updatePos)}},updatePos(){if(!this.isDraggable||this.isDraggable&&this.isDraggingHandle){let e=this.pageX-this.$el.getBoundingClientRect().left;const t=this.padding.right,i=this.padding.left;e<i?e=i:e>this.width-t&&(e=this.width-t),this.posX=e}this.isDraggingImage&&(this.shiftX+=this.diffX/this.mutableZoom,this.shiftY+=this.diffY/this.mutableZoom),this.allowNextFrame=!0},setInitialPosX(){if(this.paddingTotal>=this.width)return console.error("Sum of paddings is wider then parent element!");this.posX=(this.width+this.padding.left-this.padding.right)/2},onWheel(e){this.isZoomable&&(this.mutableZoom+=-e.deltaY/1e3,this.$nextTick(()=>{this.mutableZoom>=this.zoom.max?this.mutableZoom=this.zoom.max:this.mutableZoom<=this.zoom.min&&(this.mutableZoom=this.zoom.min)}))},onWheelClick(){let e=0;for(e=0;e<10;e++)setTimeout(this.switchImages,e*100);setTimeout(()=>this.showAfter=!0,e*100)},onRightClick(e){e.preventDefault(),this.switchImages()},debounce(e,t,i){let o;return function(){const a=this,s=arguments,r=function(){o=null,i||e.apply(a,s)},b=i&&!o;clearTimeout(o),o=setTimeout(r,t),b&&e.apply(a,s)}},switchImages(){this.showAfter=!this.showAfter},onDragEnter(){this.isSwitchable&&(console.log("onDragEnter"),this.showDropzone=!0)},onDragLeave(e){this.isSwitchable&&(console.log("onDragLeave"),e.preventDefault(),this.showDropzone=!1)},onDragOver(e){this.isSwitchable&&e.preventDefault()},onDrop(e){if(this.isSwitchable){e.preventDefault(),this.showDropzone=!1;const t=e.dataTransfer.files;if(t.length===1){console.log("drop file :",t[0]);const i=e.x,o=Math.round(window.outerWidth/2),a=i<=o;console.log("x ?",i),console.log("half ?",o),console.log("was on left side ?",a),this.loadFile(t[0],a)}else console.log("drop files :",t),this.loadFile(t[0],!0),this.loadFile(t[1],!1);this.mutableZoom=1,this.showAfter=!0,this.onResize()}},getFileName(e){return e.name},getFileSize(e){return"("+Math.round(e.size/1024)+" Ko)"},loadFile(e,t){var i=new FileReader;i.onload=o=>{t?(this.afterName=this.getFileName(e),this.afterSize=this.getFileSize(e),this.mutableAfter=o.target.result):(this.beforeName=this.getFileName(e),this.beforeSize=this.getFileSize(e),this.mutableBefore=o.target.result)},i.readAsDataURL(e)}}},y=["src"],X={class:"after-name"},M=["src"],x={class:"handle-icon left"},S={class:"handle-icon right"},E={class:"before-name"};function L(e,t,i,o,a,s){return u(),m("figure",{class:p([{full:i.full},"image-compare"]),onMousemove:t[3]||(t[3]=f((...r)=>s.onMouseMove&&s.onMouseMove(...r),["prevent"])),onClick:t[4]||(t[4]=f(r=>s.onMouseMove(r,!0),["prevent"]))},[l("div",{class:p([{visible:a.showDropzone},"drop-zone"])},"Drop 1 or 2 images here !",2),n(l("div",{style:d({width:a.posX+"px"}),class:"wrapper",onMousedown:t[0]||(t[0]=f((...r)=>s.onMouseDownImage&&s.onMouseDownImage(...r),["prevent"]))},[l("img",{src:a.mutableAfter,style:d(s.dimensions),alt:"after"},null,12,y),n(l("div",X,[c(g(s.afterLabel)+" ",1),n(l("div",{class:"size"},g(a.afterSize),513),[[h,a.afterSize]])],512),[[h,s.afterLabel]])],36),[[h,!i.hideAfter&&a.showAfter]]),l("img",{src:a.mutableBefore,style:d(s.dimensions),alt:"before",onMousedown:t[1]||(t[1]=f((...r)=>s.onMouseDownImage&&s.onMouseDownImage(...r),["prevent"]))},null,44,M),i.hideHandle?v("",!0):n((u(),m("div",{key:0,style:d({left:a.posX+"px"}),class:"handle",onMousedown:t[2]||(t[2]=f((...r)=>s.onMouseDownHandle&&s.onMouseDownHandle(...r),["prevent"]))},[l("template",null,[l("span",x,[w(e.$slots,"icon-left",{},void 0,!0)]),l("span",S,[w(e.$slots,"icon-right",{},void 0,!0)])])],36)),[[h,!i.hideAfter]]),n(l("div",E,[c(g(s.beforeLabel)+" ",1),n(l("div",{class:"size"},g(a.beforeSize),513),[[h,a.beforeSize]])],512),[[h,s.beforeLabel]])],34)}const I=D(z,[["render",L],["__scopeId","data-v-f9137fbb"]]);export{I as i};
